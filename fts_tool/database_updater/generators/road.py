from .generator import Generator
from shared.entities import Road

class RoadGenerator(Generator):
    def __init__(self):
        super().__init__()
        self.generates(Road)
        self.renames("highway", "type")
        self.renames("junction", "junction_type")
        self.renames("bicycle", "bicycle_allowed")
        self.renames("horse", "horse_allowed")
        self.renames("motor_vehicle", "motor_vehicle_allowed")
        self.renames("lanes:forward", "forward_lanes")
        self.renames("lanes:backward", "backward_lanes")
        self.renames("destination:lanes", "lane_destinations")
        self.renames("footway", "footway_type")
        self.renames("inline_skates", "inline_skates_allowed")
        self.renames("cycleway:left", "left_cycleway")
        self.renames("cycleway:right", "right_cycleway")
        self.renames("maxspeed:hgv", "maxspeed_hgv")
        self.replaces_property_value("maxspeed", "CZ:urban", "50")
        self.replaces_property_value("maxheight", "default", "4.5") # An approximation
        self.replaces_property_value("lanes_maxwidth", "|", "")
        self.renames("maxspeed:forward", "maxspeed_forward")
        self.renames("proposed:bridge", "proposed_bridge")
        self.renames("maxspeed:backward", "maxspeed_backward")
        self.renames("oneway:bicycle", "bicycle_oneway")
        self.renames("vehicle", "vehicle_allowed")
        self.renames("dog", "dogs_allowed")
        self.renames("motorcycle", "motorcycle_allowed")
        self.renames("bridge:structure", "bridge_structure")
        self.renames("oneway:tram", "tram_oneway")
        self.renames("direction", "incline")
        self.renames("FIXME", "fixme")
        self.renames("destination:symbol", "destination_symbol")
        self.renames("railway:lanes:backward", "railway_lanes_backward")
        self.renames("railway:lanes:forward", "railway_lanes_forward")
        self.renames("change:lanes:backward", "change_lanes_backward")
        self.renames("change:lanes:forward", "change_lanes_forward")
        self.renames("psv:lanes:backward", "psv_lanes_backward")
        self.renames("psv:lanes:forward", "psv_lanes_forward")
        self.renames("parking:lane:left", "parking_lane_left")
        self.renames("parking:lane:right", "parking_lane_right")
        self.renames("parking:lane:both", "parking_lane_both")
        self.renames("change:lanes", "change_lanes")
        self.renames("class:bicycle:mtb", "mtb_bicycle_class")
        self.renames("zone:traffic", "traffic_zone")
        self.renames("traffic:zone", "traffic_zone")
        self.renames("destination:backward", "backward_destination")
        self.renames("class:bicycle:mtb:technical", "technical_mtb_bicycle_class")
        self.renames("note:ref_name", "ref_name_note")
        self.renames("maxwidth:lanes", "lanes_maxwidth")
        self.renames("highway:category:pl", "pl_highway_category")
        self.renames("highway:class:pl", "pl_highway_class")
        self.renames("maxspeed:bus", "bus_maxspeed")
        self.renames("maxspeed:trailer", "trailer_maxspeed")
        self.renames("width:carriageway", "carriageway_width")
        self.renames("maxspeed:wet", "wet_maxspeed")
        self.renames("bridge:name", "bridge_name")
        self.renames("maxspeed:variable", "varialbe_maxspeed")
        self.renames("overtaking:bus", "bus_overtaking")
        self.renames("overtaking:hgv", "hgv_overtaking")
        self.renames("overtaking:trailer", "trailer_overtaking")

        self.renames("bus:lanes:backward", "bus_lanes_backward")
        self.renames("bus:lanes:forward", "bus_lanes_forward")
        self.renames("railway:lanes", "railway_lanes")
        self.renames("vehicle:lanes:backward", "vehicle_lanes_backward")
        self.renames("vehicle:lanes:forward", "vehicle_lanes_forward")
        self.renames("busway:right", "busway_right")
        self.renames("destination:colour:lanes", "destination_lanes_colours")
        self.renames("destination:forward", "forward_destination")
        self.renames("hgv:6.5t", "hgv_6_5t")
        self.renames("destination:int_ref:lanes", "destination_int_ref_lanes")
        self.renames("destination:ref:lanes", "destination_ref_lanes")
        self.renames("destination:symbol:lanes", "destination_symbol_lanes")
        self.renames("parking:condition:left", "left_parking_condition")
        self.renames("parking:condition:right", "right_parking_condition")
        self.renames("parking:lane:both:parallel", "parking_lane_both_parallel")
        self.renames("destination:int_ref", "destination_int_ref")
        self.renames("destination:ref", "destination_ref")
        self.renames("maxspeed:type", "maxspeed_type")
        self.renames("motor_vehicle:conditional", "motor_vehicle_conditional")
        self.renames("motor_vehicle:forward:conditional", "motor_vehicle_forward_conditional")
        self.renames("maxspeed:conditional", "maxspeed_conditional")
        self.renames("motor_vehicle:backward", "motor_vehicle_backward")
        self.renames("vehicle:forward", "vehicle_forward")
        self.renames("sidewalk:both:kerb", "both_sidewalk_kerb")
        self.renames("parking:lane:left:parallel", "parking_lane_left_parallel")
        self.renames("vehicle:forward:conditional", "vehicle_forward_conditional")
        self.renames("transit:lanes", "transit_lanes")
        self.renames("bicycle:lanes:forward", "bicycle_forward_lanes")
        self.renames("hour_off:hgv", "hgv_hour_off")
        self.renames("hour_on:hgv", "hgv_hour_on")
        self.renames("parking:lane:left:diagonal", "parking_lane_left_diagonal")
        self.renames("hgv:6.5", "hgv_6_5t")
        self.renames("ramp:wheelchair", "wheelchair_ramp")
        self.renames("maxheight:forward", "forward_maxheight")
        self.renames("bicycle:class:technical", "technical_bicycle_class")
        self.renames("survey:date", "survey_date")
        self.renames("abandoned:highway", "abandoned_highway")
        self.renames("note:ref_name", "ref_name_note")
        self.renames("hgv:6t", "hgv_6t")
        self.renames("bridge:ref", "bridge_ref")
        self.renames("hgv:maxspeed:conditional", "hgv_conditional_maxspeed")
        self.renames("destination:country", "destination_country")
        self.renames("note:access", "access_note")
        self.renames("footway:left.width", "left_footway_width")
        self.renames("maxspeed:forward:conditional", "forward_maxspeed_conditional")
        self.renames("hazmat:water", "hazmat_water")
        self.renames("hgv:12t", "hgv_12t")
        self.renames("hgv:3.5", "hgv_3_5t")
        self.renames("note:maxweight", "maxweight_note")
        self.renames("alt_name:de", "alt_name_de")
        self.renames("alt_name:en", "alt_name_en")
        self.renames("area:highway", "highway_area")
        self.renames("hazmat:e", "hazmat_e")
        self.renames("destination:name", "destination_name")
        self.renames("psv:lanes", "psv_lanes")
        self.renames("lanes:psv", "psv_lanes")
        self.renames("note:name", "name_note")
        self.renames("taxi:lanes", "taxi_lanes")
        self.renames("vehicle:lanes", "vehicle_lanes")
        self.renames("lanes:both_ways", "both_ways_lanes")
        self.renames("maxspeed:source", "maxspeed_source")
        self.renames("hgv:6", "hgv_6t")
        self.renames("maxspeed:advisory", "advisory_maxspeed")
        self.renames("cycleway:both", "both_cycleway")
        self.renames("parking:condition:both", "both_parking_condition")
        self.renames("parking:condition:both:default", "both_default_parking_condition")
        self.renames("parking:condition:both:residents", "both_residents_parking_condition")
        self.renames("parking:condition:both:time_interval", "both_parking_condition_time_interval")
        self.renames("zone:maxspeed", "zone_maxspeed")
        self.renames("oneway:psv", "psv_oneway")
        self.renames("psv:oneway", "psv_oneway")
        self.renames("removed:cycleway", "removed_cycleway")
        self.renames("bicycle:lanes", "bicycle_lanes")
        self.renames("hgv:maxweight", "hgv_maxweight")
        self.renames("hgv:lanes", "hgv_lanes")
        self.renames("note:reg_name", "reg_name_note")
        self.renames("note:cs", "cs_note")


        self.renames("lanes:bus", "bus_lanes")
        self.renames("his:1991-:name", "his_1991_name")
        self.renames("overtaking:conditional", "conditional_overtaking")
        self.renames("maxspeed:hgv:backward:conditional", "hgv_backward_conditional_maxspeed")
        self.renames("hgv:backward", "hgv_backward")
        self.renames("overtaking:forward", "forward_overtaking")
        self.renames("maxspeed:hgv:backward", "hgv_backward_maxspeed")
        self.renames("parking:condition:right:time_interval", "right_parking_condition_time_interval")
        self.renames("parking:lane", "parking_lane")
        self.renames("his:1945-:name", "his_1945_name")
        self.renames("parking:condition:both:residents:time_interval", "both_residents_parking_condition_time_interval")
        self.renames("placement:forward", "forward_placement")
        self.renames("overtaking:backward", "backward_overtaking")
        self.renames("his:1896-:name", "his_1896_name")
        self.renames("parking:both", "both_parking")
        self.renames("his:1400-1840:name", "his_1400_1800_name")
        self.renames("his:1870-1940:name", "his_1870_1940_name")
        self.renames("bus:backward", "backward_bus")
        self.renames("indoor:level", "indoor_level")
        self.renames("change:backward", "backward_change")
        self.renames("junction:ref", "junction_ref")
        self.renames("parking:condition:right:maxstay", "right_parking_condition_maxstay")
        self.renames("destination:note", "destination_note")
        self.renames("parking:condition:right:residents", "right_residents_parking_condition")
        self.renames("destination:street", "destination_street")
        self.renames("arcade:left", "left_arcade")
        self.renames("maxwidth:conditional", "conditional_maxwidth")
        self.renames("his:1930-:name", "his_1930_name")
        self.renames("tmc:cid_58:tabcd_1:class", "tmc_cid_58_tabcd_1_class")
        self.renames("tmc:cid_58:tabcd_1:lclversion", "tmc_cid_58_tabcd_1_lclversion")
        self.renames("tmc:cid_58:tabcd_1:nextlocationcode", "tmc_cid_58_tabcd_1_nextlocationcode")
        self.renames("overtaking:hgv:conditional", "hgv_conditional_overtaking")
        self.renames("lanes:psv:times", "psv_lanes_times")
        self.renames("his:1990-:name", "his_1990_name")
        self.renames("his:1962-:name", "his_1962_name")
        self.renames("ramp:stroller", "stroller_ramp")
        self.renames("hazard:forward", "forward_hazard")
        self.renames("sidewalk:both:surface", "both_sidewalk_surface")
        self.renames("his:1940-1945:name", "his_1940_1945_name")
        self.renames("parking:condition:right:default", "right_parking_default_condition")
        self.renames("hgv:12", "hgv_12")
        self.renames("alt_name:cs", "alt_name_cs")
        self.renames("abandoned:railway", "abandoned_railway")
        self.renames("his:1840-1870:name", "his_1840_1870_name")
        self.renames("his:1951-1990:name", "his_1951_1990_name")
        self.renames("bridge:height", "bridge_height")
        self.renames("oneway:railway", "oneway_railway")
        self.renames("proposed:highway", "proposed_highway")
        self.renames("taxi:lanes:forward", "taxi_lanes_forward")
        self.renames("destination:colour_tx:lanes", "destination_colour_tx_lanes")
        self.renames("sidewalk:right:bicycle", "right_bicycle_sidewalk")
        self.renames("sidewalk:left:bicycle", "left_bicycle_sidewalk")
        self.renames("maxspeed:backward:conditional", "backward_conditional_maxspeed")
        self.renames("description:ref", "description_ref")
        self.renames("tolltype:hgv", "hgv_tolltype")
        self.renames("note:maxheight", "maxheight_note")
    def _prepare_properties(self, entity_spec, props, record):
        if "access" in props and "@" in props["access"]: # We don't really need those finer details
            props["access"] = props["access"].split(" ")[0]
        if "incline" in props and props["incline"][0].isdigit():
            del props["incline"] # Think of a better way how to handle those
        return super()._prepare_properties(entity_spec, props, record)
    @staticmethod
    def accepts(props):
        return "highway" in props